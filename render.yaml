# CYNIC Render Blueprint
#
# Deploy: Connect repo to Render and select this file
#
# "φ distrusts φ" - κυνικός

services:
  # ===========================================================================
  # CYNIC MCP Server
  # ===========================================================================
  - type: web
    name: cynic-mcp
    runtime: docker
    dockerfilePath: packages/mcp/Dockerfile
    dockerContext: .
    region: oregon
    plan: starter
    healthCheckPath: /health
    envVars:
      - key: NODE_ENV
        value: production
      - key: MCP_MODE
        value: http
      - key: PORT
        value: 3000
      - key: CYNIC_DATABASE_URL
        fromDatabase:
          name: cynic-db
          property: connectionString
      - key: CYNIC_REDIS_URL
        fromService:
          type: redis
          name: cynic-redis
          property: connectionString
    autoDeploy: true

  # ===========================================================================
  # Redis Cache
  # ===========================================================================
  - type: redis
    name: cynic-redis
    region: oregon
    plan: starter
    maxmemoryPolicy: allkeys-lru
    ipAllowList: []  # Only internal connections

databases:
  # ===========================================================================
  # PostgreSQL Database
  # ===========================================================================
  - name: cynic-db
    region: oregon
    plan: starter
    postgresMajorVersion: 16
    ipAllowList: []  # Only internal connections
