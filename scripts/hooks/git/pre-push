#!/bin/bash
# CYNIC Pre-Push Hook — Silent mode
# Runs Da'at validation. Outputs ONLY on failure (blocks push).
# Silent on success so git push exits 0 cleanly on Windows.

SCORE=$(node scripts/tikkun/daat.mjs 2>/dev/null | grep -o 'CYNIC_SCORE=[0-9]*' | cut -d= -f2 || echo "0")
SCORE=${SCORE:-0}

if [ "$SCORE" -lt 62 ]; then
    echo "" >&2
    echo "*GROWL* Da'at score ${SCORE}% — below φ⁻¹ (62%). Push blocked." >&2
    echo "Run: node scripts/tikkun/daat.mjs" >&2
    echo "" >&2
    exit 1
fi

exit 0
